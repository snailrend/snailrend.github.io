<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>servlet 学习笔记 | 自旋向上</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="alternate" type="application/rss+xml" href="http://snailrend.github.io/rss.xml" title="自旋向上 RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="http://snailrend.github.io/feed.atom" title="自旋向上 Atom Feed">
    <link rel="alternate" type="application/json" href="http://snailrend.github.io/feed.json" title="自旋向上 JSON Feed">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.a8e1f766.css" as="style"><link rel="preload" href="/assets/js/app.65b26f92.js" as="script"><link rel="preload" href="/assets/js/2.688822e6.js" as="script"><link rel="preload" href="/assets/js/20.8ddafb15.js" as="script"><link rel="prefetch" href="/assets/js/10.c52f3046.js"><link rel="prefetch" href="/assets/js/11.19cbf741.js"><link rel="prefetch" href="/assets/js/12.bbab3e89.js"><link rel="prefetch" href="/assets/js/13.3f767b22.js"><link rel="prefetch" href="/assets/js/14.7f711bfe.js"><link rel="prefetch" href="/assets/js/15.6046bb7b.js"><link rel="prefetch" href="/assets/js/16.5d94747f.js"><link rel="prefetch" href="/assets/js/17.cefe4b7d.js"><link rel="prefetch" href="/assets/js/18.b1caf92b.js"><link rel="prefetch" href="/assets/js/19.86954bdc.js"><link rel="prefetch" href="/assets/js/21.e39934e4.js"><link rel="prefetch" href="/assets/js/22.3404e32b.js"><link rel="prefetch" href="/assets/js/23.fe222df9.js"><link rel="prefetch" href="/assets/js/24.e2d88183.js"><link rel="prefetch" href="/assets/js/25.4656273c.js"><link rel="prefetch" href="/assets/js/26.6877622b.js"><link rel="prefetch" href="/assets/js/27.91ce27c4.js"><link rel="prefetch" href="/assets/js/28.6502a414.js"><link rel="prefetch" href="/assets/js/29.24e5de17.js"><link rel="prefetch" href="/assets/js/3.9403f813.js"><link rel="prefetch" href="/assets/js/30.663a33ab.js"><link rel="prefetch" href="/assets/js/31.fa9ebfb5.js"><link rel="prefetch" href="/assets/js/32.6f6a2225.js"><link rel="prefetch" href="/assets/js/33.e5848d71.js"><link rel="prefetch" href="/assets/js/34.5ccf98bc.js"><link rel="prefetch" href="/assets/js/35.8d77177d.js"><link rel="prefetch" href="/assets/js/36.d21862f1.js"><link rel="prefetch" href="/assets/js/4.32c10b23.js"><link rel="prefetch" href="/assets/js/5.38ca723e.js"><link rel="prefetch" href="/assets/js/6.1aac1c16.js"><link rel="prefetch" href="/assets/js/7.6a90bb50.js"><link rel="prefetch" href="/assets/js/8.fa1d823e.js"><link rel="prefetch" href="/assets/js/9.bdacdf25.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a8e1f766.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">自旋向上</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="SOP" class="dropdown-title"><span class="title">SOP</span> <span class="arrow down"></span></button> <button type="button" aria-label="SOP" class="mobile-dropdown-title"><span class="title">SOP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/SOP/开发/" class="nav-link">
  开发
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="template" class="dropdown-title"><span class="title">template</span> <span class="arrow down"></span></button> <button type="button" aria-label="template" class="mobile-dropdown-title"><span class="title">template</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/template/" class="nav-link">
  Template
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/" class="nav-link">
  前端
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/后端/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/后端/数据库/" class="nav-link">
  数据库
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="环境安装" class="dropdown-title"><span class="title">环境安装</span> <span class="arrow down"></span></button> <button type="button" aria-label="环境安装" class="mobile-dropdown-title"><span class="title">环境安装</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/环境安装/" class="nav-link">
  环境安装
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="职场" class="dropdown-title"><span class="title">职场</span> <span class="arrow down"></span></button> <button type="button" aria-label="职场" class="mobile-dropdown-title"><span class="title">职场</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/职场/年终总结/" class="nav-link">
  年终总结
</a></li><li class="dropdown-item"><!----> <a href="/职场/" class="nav-link">
  职场
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计划" class="dropdown-title"><span class="title">计划</span> <span class="arrow down"></span></button> <button type="button" aria-label="计划" class="mobile-dropdown-title"><span class="title">计划</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/计划/" class="nav-link">
  计划
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="SOP" class="dropdown-title"><span class="title">SOP</span> <span class="arrow down"></span></button> <button type="button" aria-label="SOP" class="mobile-dropdown-title"><span class="title">SOP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/SOP/开发/" class="nav-link">
  开发
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="template" class="dropdown-title"><span class="title">template</span> <span class="arrow down"></span></button> <button type="button" aria-label="template" class="mobile-dropdown-title"><span class="title">template</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/template/" class="nav-link">
  Template
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/" class="nav-link">
  前端
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/后端/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/后端/数据库/" class="nav-link">
  数据库
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="环境安装" class="dropdown-title"><span class="title">环境安装</span> <span class="arrow down"></span></button> <button type="button" aria-label="环境安装" class="mobile-dropdown-title"><span class="title">环境安装</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/环境安装/" class="nav-link">
  环境安装
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="职场" class="dropdown-title"><span class="title">职场</span> <span class="arrow down"></span></button> <button type="button" aria-label="职场" class="mobile-dropdown-title"><span class="title">职场</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/职场/年终总结/" class="nav-link">
  年终总结
</a></li><li class="dropdown-item"><!----> <a href="/职场/" class="nav-link">
  职场
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计划" class="dropdown-title"><span class="title">计划</span> <span class="arrow down"></span></button> <button type="button" aria-label="计划" class="mobile-dropdown-title"><span class="title">计划</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/计划/" class="nav-link">
  计划
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/后端/java/Spring Boot 简单整合JPA.html" class="sidebar-link">Spring Boot 简单整合JPA</a></li><li><a href="/后端/java/servlet 学习笔记.html" class="active sidebar-link">servlet 学习笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/后端/java/servlet 学习笔记.html#_1-servlet是什么" class="sidebar-link">1.servlet是什么</a></li><li class="sidebar-sub-header"><a href="/后端/java/servlet 学习笔记.html#_2-生命周期" class="sidebar-link">2. 生命周期</a></li><li class="sidebar-sub-header"><a href="/后端/java/servlet 学习笔记.html#_3-servlet的执行流程" class="sidebar-link">3. Servlet的执行流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/后端/java/servlet 学习笔记.html#_1-如何配置" class="sidebar-link">(1)如何配置</a></li><li class="sidebar-sub-header"><a href="/后端/java/servlet 学习笔记.html#_2-内部是如何处理实现的" class="sidebar-link">(2) 内部是如何处理实现的</a></li></ul></li><li class="sidebar-sub-header"><a href="/后端/java/servlet 学习笔记.html#_4-servlet三大域对象" class="sidebar-link">4. Servlet三大域对象</a></li><li class="sidebar-sub-header"><a href="/后端/java/servlet 学习笔记.html#_5-servlet的请求和响应" class="sidebar-link">5. servlet的请求和响应</a></li><li class="sidebar-sub-header"><a href="/后端/java/servlet 学习笔记.html#_6-servlet的单实例多线程" class="sidebar-link">6. servlet的单实例多线程</a></li><li class="sidebar-sub-header"><a href="/后端/java/servlet 学习笔记.html#_7-session-与-cookie" class="sidebar-link">7. session 与 cookie</a></li><li class="sidebar-sub-header"><a href="/后端/java/servlet 学习笔记.html#_8-web-http请求过程-包括了解浏览器资源加载渲染原理" class="sidebar-link">8.web http请求过程（包括了解浏览器资源加载渲染原理）</a></li></ul></li><li><a href="/后端/java/关于并发工具的结构笔记.html" class="sidebar-link">关于并发工具的结构笔记</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="servlet-学习笔记"><a href="#servlet-学习笔记" class="header-anchor">#</a> servlet 学习笔记</h1> <h2 id="_1-servlet是什么"><a href="#_1-servlet是什么" class="header-anchor">#</a> 1.servlet是什么</h2> <p>​	Java Servlet 是运行在 Web 服务器或应用服务器上的程序，它可以用来处理HTTP请求。</p> <p>​	但实际上 Servlet 本身只是一个规范,在代码上表现为接口,真正处理 HTTP 请求的是 Servlet 的实现类。用户可以实现 Servlet ，然后将 Servlet 的实现类放在 Servlet 容器中（例如 Tomcat），容器去监听 HTTP 请求，然后根据URL调用对应的 Servle来处理请求。</p> <h2 id="_2-生命周期"><a href="#_2-生命周期" class="header-anchor">#</a> 2. 生命周期</h2> <p>Servlet 从创建到销毁会经过三个过程：</p> <ol><li><p>init（）</p> <p>servlet 通过 init（）方法进行初始化，可以在这里加载所需要的资源</p></li> <li><p>service（）</p> <p>servlet 的 service（）方法负责处理请求，并返回对应信息。</p></li> <li><p>destroy（）</p> <p>servlet 的 destroy（）方法负责执行销毁操作，可以在这里释放相关的资源，当 servlet 被销毁的时候就会调用 destroy （）方法。</p></li></ol> <h2 id="_3-servlet的执行流程"><a href="#_3-servlet的执行流程" class="header-anchor">#</a> 3. Servlet的执行流程</h2> <h3 id="_1-如何配置"><a href="#_1-如何配置" class="header-anchor">#</a> (1)如何配置</h3> <p>servlet 的实现类创建好后，需要在项目的 <code>web/WEB-INF/web.xml</code> 中进行配置，只有配置之后，才能让 Servlet 容器根据 URL 调用对应的 Servlet 进行处理。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://xmlns.jcp.org/xml/ns/javaee<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--    声明一个 Servlet 的存在,并且为它定义一个名字--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>ServletName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>DemoServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--    声明一个映射关系并且为 ServletName 对应的 Servlet 指定一个 URL--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>ServletName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/ServletURL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_2-内部是如何处理实现的"><a href="#_2-内部是如何处理实现的" class="header-anchor">#</a> (2) 内部是如何处理实现的</h3> <p>通过上面的配置，可以让 Servlet 容器根据 <code>URL</code> 调用对应的 <code>Servlet</code>实例，具体来说就是调用 <code>Servlet#service</code>方法.</p> <p>如果是直接实现 <code>Servlet</code>接口，那么就可以在 <code>Servlet#service</code>方法写业务代码即可，根据请求的方法（<code>GET</code>、<code>POST</code>、<code>PUT</code>、<code>DELETE</code>等方法）决定如何处理此次请求。</p> <p>不过 Java 也有其他实现了 <code>Servlet</code>接口的抽象类，对其进行了封装，有更多较为方便的操作。例如<code>HttpServlet</code>类，一般创建<code>servlet</code>实现类的时候都是实现的<code>HttpServlet</code>，它提供了两个必须被实现的抽象方法<code>doGet</code>与<code>doPost</code>，在类的内部直接根据请求的方法分别调用这两个抽象方法，若是继承了 <code>HttpServlet</code>，则可以只实现这两个方法就可以运行。</p> <h2 id="_4-servlet三大域对象"><a href="#_4-servlet三大域对象" class="header-anchor">#</a> 4. Servlet三大域对象</h2> <p><code>Servlet</code>有三大域对象：</p> <ul><li><p>request</p> <ul><li><p>类型：ServletRequest</p></li> <li><p>作用域：当前请求</p></li> <li><p>创建时间：<code>Servlet</code>接到一个请求的时候就创建一个 request</p></li> <li><p>销毁时间：请求结束时被销毁</p></li> <li><p>使用场景：用于在<code>HTTP</code>客户端与服务端应用间传输数据，也可以通过<code>请求转发</code>在<code>Servlet</code>之间传输。</p></li> <li><p>使用方法：</p> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span>HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span>HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span>ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//获取 HTTP 客户端传递的参数</span>
        request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;keyOne&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置一个属性到 request 中，指定属性名与值,值可以是对象,可在转发到其他 Servlet 中的时候被使用</span>
        request<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;keyThree&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取之前设置的属性值</span>
        request<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;keyTwo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取 HTTP 客户端传递的请求头</span>
        request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Host&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>session</p> <ul><li><p>类型：HttpSession</p></li> <li><p>作用域：当前会话有效，会话就是用户浏览器访问页面后到<code>session</code>过期或者用户关闭页面的这段时间</p></li> <li><p>创建时间：用户第一次访问页面时</p></li> <li><p>销毁时间：<code>session</code>过期或者被手动调用<code>session. invalidate()</code>方法后销毁</p></li> <li><p>使用场景：因为在<code>session</code>中的数据可以在用户的整个会话中被访问，可以存储用户的临时数据，或者保存用户的登录状态等等，不过因为<code>session</code>的访问依赖 <code>cookie</code>，而<code>cookie</code>是不安全的，所以<code>servlet</code>的<code>session</code>也有较大的数据泄露风险。</p></li> <li><p>使用方法：</p> <div class="language-java extra-class"><pre class="language-java"><code>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span>HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span>HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span>ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//根据请求获取对应的 session</span>
        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//向 session 中设置属性,并指定属性名与值,方便在下次请求中使用</span>
        session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;keyFour&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//根据属性名获取之前设置的值</span>
        session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;keyFour&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//删除一个属性</span>
        session<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;keyFour&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//销毁当前的 session</span>
        session<span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>application</p> <ul><li><p>类型：ServletContext</p></li> <li><p>作用域：整个应用</p></li> <li><p>创建时间：应用启动时</p></li> <li><p>销毁时间：应用销毁时</p></li> <li><p>使用场景：可以存储应用的状态，例如存储当前的在线人数等</p></li> <li><p>使用方法：</p> <div class="language-java extra-class"><pre class="language-java"><code>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span>HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span>HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span>ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        
        <span class="token comment">//获取应用上下文,this.getServletContext()并非是 Servlet 接口的方法,而是实现了 Servlet 接口的 HttpServlet 抽象类所提供的方法</span>
        <span class="token comment">//HttpServlet 抽象类同时也实现了 ServletConfig,getServletContext()方法就是 ServletConfig 接口提供的</span>
        <span class="token class-name">ServletContext</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">////向 Application 中设置属性,并指定属性名与值,这个属性在整个应用范围都可以被访问</span>
        context<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;keyFive&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//通过一个属性名,获取对应属性的值</span>
        context<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;keyFive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//通过属性名,删除一个属性</span>
        context<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;keyFive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul> <h2 id="_5-servlet的请求和响应"><a href="#_5-servlet的请求和响应" class="header-anchor">#</a> 5. servlet的请求和响应</h2> <p><code>当Servlet</code>容器接到请求的时候，就会去调用对应<code>Servlet</code>的 <code>service（）</code>方法，<code>Servlet#service</code>方法有需要两个参数：</p> <p><code>request：ServletRequest</code>：携带<code>HTTP</code>请求的相关信息，包括请求参数、请求头等数据。</p> <p><code>response：ServletResponse</code>：请求处理完成后要返回的对象，如果有需要返回的数据可以通过此对象返回。</p> <ul><li><p><code>request</code>可以访问客户端传来的参数，如果此次请求是被转发而来，也可以获得其他<code>Servlet</code>设置的属性，通过<code>request</code>可以获得此次请求的方法，可以根据方法选择对应的处理方式。也可以通过<code>request</code>将此次的请求转发到其他<code>Servlet</code>，也可以通过<code>request</code>获得当前会话的<code>session</code>，对一些数据进行暂时的存储。</p></li> <li><p><code>response</code>装载着需要返回给客户端的数据。可以设置请求的状态值、返回错误给客户端，错误可以携带提示信息。也可以将当前请求重定向到新的地址，重定向跟转发不一样，无法携带<code>request</code>，所以没法共享当前<code>Servlet</code>的数据，重定向就相当于让客户端重新发起了一个新的请求到另一个<code>URL</code>。</p></li></ul> <h2 id="_6-servlet的单实例多线程"><a href="#_6-servlet的单实例多线程" class="header-anchor">#</a> 6. servlet的单实例多线程</h2> <p><code>Servlet</code>是单实例的，当<code>Servlet容器</code>接到一个请求时，首先检查对应的<code>Servlet</code>实例是否已经被创建，如果已经被创建了，就不会再创建。</p> <p>但是 <code>Servlet</code>是在多线程环境下运行的，每当容器接到一个请求，就会分配或创建一个线程去执行<code>Servlet</code>，单例的<code>Servlet</code>节省了每次都创建<code>Servlet</code>的资源浪费，但是也会使得<code>Servlet</code>有线程不安全的风险，解决线程不安全有两种：</p> <ul><li><p>不在<code>Servlet</code>中创建任何属性,避免多个线程访问同一个属性，导致线程不安全。</p></li> <li><p>使用<code>synchronized</code>关键字为使用到的<code>Servlet</code>属性加锁。</p> <p>相对来说使用第一种方法较好，因为<code>synchronized</code>较为耗费资源，如果可以避免使用属性，则可以提高许多性能。</p></li></ul> <h2 id="_7-session-与-cookie"><a href="#_7-session-与-cookie" class="header-anchor">#</a> 7. session 与 cookie</h2> <p>简单来说<code>session</code>中的数据是存储在服务器内存中的,<code>cookie</code>是存储在客户端浏览器中的.</p> <p><code>cookie</code>只能存储ASCII字符串,按照键值对的形式存储在客户端的内存或者硬盘中,具体是存储在内存还是硬盘要看<code>cookie</code>的过期时间,如果没有设置过期时间,那么<code>cookie</code>的有效期是在用户关闭页面前,这个时候就是存储在内存中,如果设置的有效时间,那么就是存储在硬盘中,浏览器一般会给每个<code>cookie</code>设置其所属域名,在请求资源的时候会自动带上对应域名的<code>cookie</code>.</p> <p><code>cookie</code>可以通过<code>JavaScript</code>代码在浏览器环境设置,也可以通过在请求后端服务器时服务器返回响应头携带来设置<code>cookie</code>.因为<code>cookie</code>相对于用户是可见的,并且会随着请求自动的发送<code>cookie</code>,所以<code>cookie</code>是不安全的,容易被非法用户获取到用户的隐私信息,容易被CSRF(跨站请求伪造)攻击.</p> <p><code>seesion</code>的数据是存储在服务器内存中的,同样是以键值对的方式存储,存储类型可以是任何Java类型或对象,<code>seesion</code>的有效期最长是一个会话时间,<code>HTTP</code>请求是没有状态的,识别会话是否结束是通过浏览器<code>cookie</code>,当服务器获得一个请求就会检查请求头中是否有<code>sessionId</code>字段,如果有,就按照<code>sessionId</code>获取对应的<code>session</code>,如果没有,则创建一个新的<code>session</code>并且将<code>sessionId</code>放到响应头,存储到客户端浏览器的<code>cookie</code>中,以便下次访问服务器的时候可以识别会话,所以<code>session</code>的会话时间其实是根据自动传递的<code>cookie</code>来识别的,根据<code>cookieId</code>的不同<code>session</code>也不同,所以也可以说是<code>cookie</code>决定了<code>session</code>.这样一来如果<code>cookie</code>泄露,那么尽管<code>session</code>是存储在服务器内存中也会有数据泄露的风险.</p> <h2 id="_8-web-http请求过程-包括了解浏览器资源加载渲染原理"><a href="#_8-web-http请求过程-包括了解浏览器资源加载渲染原理" class="header-anchor">#</a> 8.web http请求过程（包括了解浏览器资源加载渲染原理）</h2> <p>从输入<code>URL</code>到浏览器中的地址栏进行访问,到浏览器进行页面渲染请求结束经过了6个步骤:</p> <ul><li><p>DNS 解析</p> <p>解析出<code>URL</code>中的域名,请求<code>DNS</code>服务器,获得对应域名的 IP 地址</p></li> <li><p>TCP 连接</p> <p>获取到IP地址后将确认客户端与服务器之间的网络是否通畅,需要进行三次握手以确保互相能够听到对方发出的信息,三次握手顺序如下:</p> <ul><li><p>客户端发送报文:<code>SYN=1 Seq=X</code></p> <p>其中<code>SYN=1</code>表示向服务器要求要建立连接,<code>Seq=X</code>代表当前的请求码,其中<code>X</code>是随机的整型数值.</p></li> <li><p>服务器回应报文:<code>SYN=1 ACK=X+1 Seq=Y</code></p> <p>其中<code>SYN=1</code>表示服务器统一建立连接,<code>ACK=X+1</code>中的<code>X</code>是之前客户端发向服务器的<code>Seq</code>的值,将其加一之后发送回客户端表示服务器接到了客户端的请求,并且接到的数据无误,<code>Seq=Y</code>是代表本次报文发送的请求码.</p></li> <li><p>客户端回应报文:<code>ACK=Y+1 Seq=Z</code></p> <p>客户端接收到服务器的回应报文后,检查其<code>ACK</code>的值,是否是之前客户端发送的<code>Seq</code>值加一,如果是的话,就将服务器回应报文的<code>Seq</code>的值加一,放到<code>ACK</code>中返回,并且随机生成并发送本次请求码<code>Seq=Z</code>.</p></li></ul> <p>经过三次握手之后,客户端可以确认服务器能够接收到自己发送的信息,服务器也可以确认客户端可以接受到自己发送的信息.</p></li> <li><p>发送 HTTP 请求</p> <p>经过三次握手后就真正的开始发送请求,请求包括三个部分:</p> <ul><li><p>请求行</p> <p>请求行包括:请求方法,URL,协议版本三个信息</p></li> <li><p>请求头</p> <p>请求头以回车与换行作为字段与字段的分界,在字段中以<code>:</code>来分割字段名与字段值.</p></li> <li><p>请求体</p> <p>请求体是具体的字符串数据</p></li></ul></li> <li><p>服务器处理请求并返回 HTTP 报文</p> <p>服务器返回的报文中有三个部分:相应行、响应头、响应体,响应头与响应体跟请求头、请求体的格式一样,但是响应头是不大一样,响应头包含了协议版本、状态码、原因短语也就是消息。</p></li> <li><p>浏览器解析渲染页面</p> <p>浏览器解析渲染页面分为一下五个步骤：</p> <ul><li>根据 HTML 解析出 DOM 树</li> <li>根据 CSS 解析生成 CSS 规则树</li> <li>结合 DOM 树和 CSS 规则树，生成渲染树</li> <li>根据渲染树计算每一个节点的信息</li> <li>根据计算好的信息绘制页面</li></ul></li> <li><p>断开连接</p> <p>数据传送完毕需要断开连接，断开连接需要经过TCP 四次握手，断开连接一般是客户端主动断开连接，四次握手发送的报文如下：</p> <ul><li><p>客户端发送报文：<code>Fin=1 ACK=Z Seq=X</code></p> <p><code>Fin=1</code>表示要断开连接客户端没有数据要发送了，<code>ACK=Z</code>表示发送一个确认码，<code>Seq=X</code>代表当前的请求码,客户端进入<code>FIN_WATI_1</code>状态。</p></li> <li><p>服务器回应报文：<code>ACK=X+1 Seq=Z</code></p> <p><code>ACK=X+1</code>表示接到断开连接的请求，直到没有数据要从客户端发送数据了，并确认信息无误。客户端进入<code>FIN_WATI_2</code>状态</p></li> <li><p>服务器回应报文：<code>Fin=1 ACK=X Seq=Y</code></p> <p>当服务端要发送的数据已经发送完毕，就发送此次报文，<code>Fin=1</code>表示请求断开连接，同时服务端进入<code>LAST_ACK</code></p></li> <li><p>客户端回应报文：<code>ACK=Y Seq=X</code></p> <p>客户端确认收到断开连接请求，发送报文确认已收到。客户端进入<code>TIME_WATIE</code>，服务端收到此次报文后就会真正断开连接，客户端等待<code>2MSL</code>后没有收到回复的话，也断开连接。</p></li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/后端/java/Spring Boot 简单整合JPA.html" class="prev">
        Spring Boot 简单整合JPA
      </a></span> <span class="next"><a href="/后端/java/关于并发工具的结构笔记.html">
        关于并发工具的结构笔记
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.65b26f92.js" defer></script><script src="/assets/js/2.688822e6.js" defer></script><script src="/assets/js/20.8ddafb15.js" defer></script>
  </body>
</html>
